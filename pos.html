<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Punto de Venta - Nayliz FP</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="pos-fullpage">
    <!-- Header del POS -->
    <header class="pos-page-header">
        <div class="pos-header-left">
            <button class="btn-back-home" onclick="volverAlMenu()">
                ‚Üê Volver al Men√∫
            </button>
            <h1>PUNTO DE VENTA</h1>
        </div>
        <div class="pos-header-right">
            <div class="pos-dolar-display">
                <span class="dolar-label">Tasa:</span>
                <span class="dolar-value" id="tasaDolarPOS">Bs 36.50</span>
            </div>
        </div>
    </header>

    <!-- Contenedor Principal del POS -->
    <div class="pos-main-container">
        <!-- Panel Izquierdo - B√∫squeda de Productos -->
        <div class="pos-left-panel">
            <div class="search-section">
                <h3>üîç Buscador de productos</h3>
                <input type="text" id="buscarProductoPOS" class="pos-search-input" 
                       placeholder="Buscar por c√≥digo o nombre..." 
                       oninput="buscarEnPOS(this.value)"
                       onkeydown="manejarTeclasBusqueda(event)">
            </div>
            
            <!-- Resultados de B√∫squeda -->
            <div class="productos-disponibles">
                <div id="resultados-busqueda" class="resultados-lista">
                    <div class="no-products">Busca un producto para agregar a la venta</div>
                </div>
            </div>
        </div>
        
        <!-- Panel Derecho - Carrito -->
        <div class="pos-right-panel">
            <!-- Tabla de Productos en el Carrito -->
            <div class="productos-agregados-section-full">
                <h3>üõí Productos en el Carrito</h3>
                <div class="table-wrapper">
                    <table class="pos-carrito-table" id="tabla-carrito">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>C√≥digo</th>
                                <th>Producto</th>
                                <th>Cant.</th>
                                <th>Precio $</th>
                                <th>Precio Bs</th>
                                <th>Total Bs</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="carritoProductos">
                            <tr>
                                <td colspan="8" class="carrito-vacio">No hay productos en el carrito</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Totales y Botones -->
            <div class="totales-section-pos-simple">
                <!-- Monto Total a Pagar -->
                <div class="monto-total-display">
                    <div class="monto-valores-inline">
                        <div class="monto-item">
                            <span class="monto-label-small">TOTAL:</span>
                            <span class="monto-dolares" id="total-usd">$0.00</span>
                        </div>
                        <div class="monto-item">
                            <span class="monto-label-small">TOTAL Bs:</span>
                            <span class="monto-bolivares" id="total-bs">Bs 0.00</span>
                        </div>
                    </div>
                </div>
                
                <!-- Botones de Acci√≥n -->
                <div class="action-buttons-pos">
                    <button class="btn-pos btn-procesar" onclick="abrirModalPagos()">
                        üí≥ Procesar Pago
                    </button>
                    <button class="btn-pos btn-limpiar" onclick="limpiarCarrito()">
                        üóëÔ∏è Limpiar Carrito
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Pagos Mixtos -->
    <div id="modalPagosMixtos" class="modal-overlay" style="display: none;">
        <div class="modal-pagos-mixtos">
    <div class="modal-pagos-header-compacto">
        <h2>üí∞ PROCESAR PAGO</h2>
        <button class="btn-close-modal-small" onclick="cerrarModalPagos()">‚úï</button>
    </div>
    
    <div class="modal-pagos-body-compacto">
        <!-- Panel Izquierdo: Totales y Tabla -->
        <div class="pagos-panel-izquierdo-compacto">
            <div class="total-venta-box-small">
                <span class="label-mini">TOTAL A PAGAR</span>
                <div class="montos-principales">
                    <span class="usd-big" id="totalVentaUSD">$0.00</span>
                    <span class="bs-medium" id="totalVentaBS">Bs 0.00</span>
                </div>
            </div>
            
            <div class="pagos-agregados-container">
                <span class="label-mini">PAGOS REGISTRADOS</span>
                <div class="tabla-scroll-mini">
                    <table class="tabla-pagos-compacta">
                        <tbody id="listaPagosAgregados">
                            <!-- Filas din√°micas -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Panel Derecho: Registro y Estado -->
        <div class="pagos-panel-derecho-compacto">
            <div class="registro-pago-card">
                <div class="form-compacto">
                    <div class="input-group-mini">
                        <label>M√©todo (F4-F9):</label>
                        <select id="metodoPago" class="select-compacto" onchange="seleccionarMetodoPago(this.value)">
                            <option value="EFECTIVO_USD">F4 - Efectivo USD</option>
                            <option value="EFECTIVO_BS">F5 - Efectivo Bs</option>
                            <option value="BIOPAGO">F6 - Biopago</option>
                            <option value="PUNTO_VENTA">F7 - Punto de Venta</option>
                            <option value="PAGO_MOVIL">F8 - Pago M√≥vil</option>
                            <option value="NOTA_CREDITO">F9 - Nota Cr√©dito</option>
                        </select>
                    </div>
                    
                    <div class="input-group-mini">
                        <label id="labelMonedaInput">Monto:</label>
                        <input type="number" id="montoPago" class="input-monto-compacto" step="0.01">
                    </div>

                    <button class="btn-agregar-compacto" onclick="agregarMetodoPago()">
                        + AGREGAR PAGO (Enter)
                    </button>
                </div>
            </div>
            
            <div class="resumen-pago-card">
                <div class="progreso-mini">
                    <div class="barra-fondo-mini"><div class="barra-relleno-mini" id="barraProgresoPago"></div></div>
                    <span id="porcentajePago">0%</span>
                </div>
                
                <div class="linea-estado">
                    <span>PAGADO:</span>
                    <b class="pos" id="totalPagado">$0.00 (Bs 0.00)</b>
                </div>
                <div class="linea-estado">
                    <span>FALTANTE:</span>
                    <b class="neg" id="faltantePago">$0.00 (Bs 0.00)</b>
                </div>
                <div id="cambioSection" class="linea-estado" style="display: none;">
                    <span>CAMBIO:</span>
                    <b class="blu" id="cambioPago">$0.00 (Bs 0.00)</b>
                </div>
            </div>

            <div id="opcionesCambio" class="cambio-box-mini" style="display: none;">
                <label>Entregar Cambio:</label>
                <div class="inputs-cambio-row">
                    <input type="number" id="cambioUSD" placeholder="En $" oninput="calcularCambioBs()">
                    <input type="number" id="cambioBS" placeholder="En Bs" readonly>
                </div>
            </div>
            
            <button class="btn-finalizar-venta-pago-mini" onclick="finalizarVentaConPagos()" id="btnFinalizarPago" disabled>
                ‚úì FINALIZAR COMPRA
            </button>
        </div>
    </div>
</div>
             </div>

    <!-- Modal/Tarjeta de Cantidad -->
    <div id="modalCantidadProducto" class="modal-overlay" style="display: none;">
        <div class="modal-cantidad-producto">
            <div class="modal-cantidad-header">
                <h3 id="nombreProductoCantidad">Producto</h3>
                <span class="codigo-producto-cantidad" id="codigoProductoCantidad">C√≥d: 000</span>
            </div>
            <div class="modal-cantidad-body">
                <div class="precio-info-cantidad">
                    <div class="precio-unitario">
                        <span class="precio-label">Precio Unitario:</span>
                        <div class="precios-valores">
                            <span class="precio-dolar" id="precioDolarCantidad">$0.00</span>
                            <span class="precio-bs" id="precioBsCantidad">Bs 0.00</span>
                        </div>
                    </div>
                </div>
                
                <div class="cantidad-input-section">
                    <label>Cantidad:</label>
                    <input type="number" id="inputCantidadProducto" class="input-cantidad-producto" 
                           value="1" step="0.01" min="0.01" autocomplete="off">
                </div>
                
                <div class="total-producto-cantidad">
                    <span class="total-label">TOTAL A PAGAR:</span>
                    <div class="total-valores">
                        <span class="total-dolar" id="totalDolarCantidad">$0.00</span>
                        <span class="total-bs" id="totalBsCantidad">Bs 0.00</span>
                    </div>
                </div>
                
                <div class="modal-cantidad-buttons">
                    <button class="btn-cantidad-confirmar" onclick="confirmarCantidadProducto()">
                        ‚úì Agregar (Enter)
                    </button>
                    <button class="btn-cantidad-cancelar" onclick="cancelarCantidadProducto()">
                        ‚úó Cancelar (Esc)
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
